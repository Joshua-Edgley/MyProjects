
-- Create the Solent Boat Database (SBD)

create database SBD;

-- Create the customer table 

CREATE TABLE CUSTOMER (
CUST_ID SERIAL PRIMARY KEY NOT NULL,
CUST_FNAME VARCHAR(25) NOT NULL,
CUST_LNAME VARCHAR(35) NOT NULL,
TELEPHONE INT NOT NULL,
EMAIL VARCHAR(255) NOT NULL,
ADDR1 VARCHAR(50) NOT NULL,
ADDR2 VARCHAR(50),
POSTCODE CHAR(9) NOT NULL,
TOWN VARCHAR(60) NOT NULL
);

-- CREATE BOAT YARD TABLE 

CREATE TABLE BOAT_YARD(
YARD_ID SERIAL NOT NULL,
YARD_SIZE VARCHAR(10) NOT NULL,
ADDR1 VARCHAR(40) NOT NULL,
ADDR2 VARCHAR(40),
POSTCODE CHAR(9) NOT NULL,
TOWN VARCHAR(40) NOT NULL,
PRIMARY KEY (YARD_ID)
);

-- CREATE THE BOAT DETAILS TABLE 

CREATE TABLE BOAT_DETAILS(
BOAT_ID SERIAL NOT NULL,
BOAT_NAME VARCHAR(40) NOT NULL,
PRODUCTION_DATE DATE NOT NULL,
FUEL_TYPE VARCHAR(20),
BOAT_DIMENSIONS VARCHAR(30) NOT NULL,
ENGINE_SIZE VARCHAR(20),
CAPACITY INT NOT NULL,
YARD_ID INT NOT NULL,
PRIMARY KEY (BOAT_ID),
FOREIGN KEY (YARD_ID) REFERENCES BOAT_YARD(YARD_ID)
);


--CREATE STAFF TABLE 

CREATE TABLE STAFF(
STAFF_ID SERIAL NOT NULL,
STAFF_FNAME VARCHAR(25) NOT NULL,
STAFF_LNAME VARCHAR(35) NOT NULL,
TELEPHONE INT NOT NULL,
EMAIL VARCHAR(255) NOT NULL,
ADDR1 VARCHAR(50) NOT NULL,
ADDR2 VARCHAR(50),
POSTCODE CHAR(9) NOT NULL,
TOWN VARCHAR(60) NOT NULL,
YARD_ID INT NOT NULL,
PRIMARY KEY (STAFF_ID),
FOREIGN KEY (YARD_ID) REFERENCES BOAT_YARD(YARD_ID)
);

--CREATE ROLES TABLE 

CREATE TABLE ROLES(
    ROLE_ID SERIAL PRIMARY KEY NOT NULL,
    ROLE_NAME VARCHAR(30) NOT NULL
);

--CREATE SERVICING TABLE 

CREATE TABLE SERVICING(
    SERVICE_ID SERIAL NOT NULL,
    COMPLETED BOOLEAN,
    SERVICE_DATE DATE NOT NULL,
    PART VARCHAR(50),
    YARD_ID INT NOT NULL,
    BOAT_ID INT NOT NULL,
    PRIMARY KEY (SERVICE_ID),
    FOREIGN KEY (YARD_ID) REFERENCES BOAT_YARD(YARD_ID),
    FOREIGN KEY (BOAT_ID) REFERENCES BOAT_DETAILS(BOAT_ID)
);

--CREATE STAFF_SERVICE LINK TABLE 
--THE STAFF AND SERVICE ENTITIES ARE BOTH PRIMARY AND FOREIGN KEYS IN THIS TABLE 

CREATE TABLE STAFF_SERVICE(
    STAFF_ID INT NOT NULL REFERENCES STAFF(STAFF_ID),
    SERVICE_ID INT NOT NULL REFERENCES SERVICING(SERVICE_ID),
    PRIMARY KEY (STAFF_ID, SERVICE_ID)
);

--CREATE STAFF_ROLE LINK TABLE 
--THE STAFF AND ROLE ENTITIES ARE BOTH PRIMARY AND FOREIGN KEYS IN THIS TABLE 
 
CREATE TABLE STAFF_ROLE(
    ROLE_ID INT NOT NULL REFERENCES ROLES(ROLE_ID),
    STAFF_ID INT NOT NULL REFERENCES STAFF(STAFF_ID),
    PRIMARY KEY (ROLE_ID, STAFF_ID)
);

--CREATE BOAT_CUST LINK TABLE
--THE BOAT AND CUSTOMER ENTITIES ARE BOTH PRIMARY AND FOREIGN KEYS IN THE TABLE 

CREATE TABLE BOAT_CUST(
    CUST_ID INT NOT NULL REFERENCES CUSTOMER(CUST_ID),
    BOAT_ID INT NOT NULL REFERENCES BOAT_DETAILS(BOAT_ID),
    PRIMARY KEY (CUST_ID, BOAT_ID)
);

--ALL CODE BELOW IS USED TO POPULATE EACH TABLE WITHIN THE DATABASE 

--ROLES 

INSERT INTO ROLES (ROLE_NAME) VALUES 

